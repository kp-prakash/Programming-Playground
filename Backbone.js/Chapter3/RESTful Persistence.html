<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <title>RESTful Persistence</title>
</head>
<body>
    <div id="todo">
    </div>
    <script type="text/template" id="item-template">
        <div>
            <input id="todo_complete" type="checkbox" <%= completed ? 'checked="checked"' : '' %>>
            <%= title %>
        </div>
    </script>
    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
    </script>
    <script src="http://documentcloud.github.com/underscore/underscore-min.js">
    </script>
    <script src="http://documentcloud.github.com/backbone/backbone-min.js">
    </script>-->
    <script src="scripts/jquery-1.10.1.js"></script>
    <script src="scripts/underscore.js"></script>
    <script src="scripts/backbone.js"></script>
    <script>
        /*Backbone dramatically simplifies the code you need to write to perform
        RESTful synchronization with a server through a simple API on its models and
        collections.*/

        //-------------------------------------------------------------------------------------
        //Fetching Models from the Server
        //-------------------------------------------------------------------------------------

        /*Collections.fetch() retrieves a set of models from the server in the form of a JSON
        array by sending an HTTP GET request to the URL specified by the collection’s url
        property (which may be a function). When this data is received, a set() will be executed
        to update the collection.*/

        /*
        var Todo = Backbone.Model.extend({
            defaults: {
                title: '',
                completed: false
            }
        });
        var TodosCollection = Backbone.Collection.extend({
            model: Todo,
            url: '/todos'
        });
        var todos = new TodosCollection();
        todos.fetch(); // sends HTTP GET to /todos
        */

        //-------------------------------------------------------------------------------------
        //Saving Models to the Server
        //-------------------------------------------------------------------------------------

        /*save() is called on a model that was fetched from the server, it constructs a URL by
        appending the model’s id to the collection’s URL and sends an HTTP PUT to the server.
        If the model is a new instance that was created in the browser (it doesn’t have an id),
        then an HTTP POST is sent to the collection’s URL.*/

        /*Collections.create() can be used to create a new model, add it 
        to the collection, and send it to the server in a single method call.*/

        /*
        var todo2 = todos.get(2);
        todo2.set('title', 'go fishing');
        todo2.save(); // sends HTTP PUT to /todos/2
        todos.create({ title: 'Try out code samples' });
         // sends HTTP POST to /todos and adds to collection
        */

        /*As mentioned earlier, a model’s validate() method is called automatically by save()
        and will trigger an invalid event on the model if validation fails.*/

        //-------------------------------------------------------------------------------------
        //Deleting Models from the Server
        //-------------------------------------------------------------------------------------

        /*You can remove a model from the containing collection and the server by calling its
        destroy() method. Unlike Collection.remove(), which only removes a model from
        a collection, Model.destroy() will also send an HTTP DELETE to the collection’s URL.*/

        /*
        var todo2 = todos.get(2);
        todo2.destroy(); // sends HTTP DELETE to /todos/2 and removes from collection
        */
        
        //Calling destroy on a model will return false if the model isNew:
        /*
        var Todo = new Backbone.Model();
        console.log(Todo.destroy());
        */
        // false

        //-------------------------------------------------------------------------------------
        //Options
        //-------------------------------------------------------------------------------------
        /*Each RESTful API method accepts a variety of options. Most importantly, all methods
        accept success and error callbacks that can be used to customize the handling of server
        responses.

        Specifying the {patch: true} option to Model.save() will cause it to use HTTP
        PATCH to send only the changed attributes (such as partial updates) to the server instead
        of the entire model—that is model.save(attrs, {patch: true}):*/

        /*Similarly, passing the {reset: true} option to Collection.fetch() will result in the
        collection being updated using reset() rather than set().
        See the Backbone.js documentation for full descriptions of the supported options.*/
    </script>
</body>
</html>